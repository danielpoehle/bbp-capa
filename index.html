<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">    
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    
    <title>BBP Kapa</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BmbxuPwQa2lc/FVzBcNJ7UAyJxM6wuqIj61tLrc4wSX0szH/Ev+nYRRuWlolflfl" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta2/dist/js/bootstrap.bundle.min.js" integrity="sha384-b5kHyXgcpbZJO/tY9Ul7kGkf1S0CWuKcCD38l8YkeH8z8QjE0GmW1gYU5S9FOnJ0" crossorigin="anonymous"></script>
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.6.0/dist/umd/popper.min.js" integrity="sha384-KsvD1yqQ1/1+IA7gi3P0tyJcT3vR+NdBTt13hSJ2lnve8agRGXTTyNaBYmCR/Nwi" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta2/dist/js/bootstrap.min.js" integrity="sha384-nsg8ua9HAw1y0W1btsyWgBklPnCUAFLuTMS2G72MMONqmOymq585AcH49TLBQObG" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.9.0/js/bootstrap-datepicker.min.js" integrity="sha512-T/tUfKSV1bihCnd+MxKD0Hm1uBBroVYBOYSk1knyvQ9VyZJpc/ALb4P0r6ubwVPSGB2GvjeoMAJJImBG12TiaQ==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/angular.js/1.8.2/angular.min.js" integrity="sha512-7oYXeK0OxTFxndh0erL8FsjGvrl2VMDor6fVqzlLGfwOQQqTbYsGPv4ZZ15QHfSk80doyaM0ZJdvkyDcVO7KFA==" crossorigin="anonymous"></script>
    


    <script src="https://kit.fontawesome.com/b6b808bbca.js" crossorigin="anonymous"></script>

    <script src="./hlp/angularjs-dropdown-multiselect.min.js"></script>
    <script src="./hlp/csvtojson.min.js"></script>
    <script src="./hlp/luxon.min.js"></script>
    <script src="./MapBBCodeLoader.js"></script>
    <script src="./app.js"></script>

    <script>
      $(function () {
        $.fn.datepicker.dates['de'] = {
          days: ["Sonntag", "Montag", "Dienstag", "Mittwoch", "Donnerstag", "Freitag", "Samstag"],
          daysShort: ["So", "Mo", "Di", "Mi", "Do", "Fr", "Sa"],
          daysMin: ["So", "Mo", "Di", "Mi", "Do", "Fr", "Sa"],
          months: ["Januar", "Februar", "März", "April", "Mai", "Juni", "Juli", "August", "September", "Oktober", "November", "Dezember"],
          monthsShort: ["Jan", "Feb", "Mär", "Apr", "Mai", "Jun", "Jul", "Aug", "Sep", "Okt", "Nov", "Dez"],
          today: "Heute",
          clear: "Löschen",
          format: "dd.mm.yyyy",
          titleFormat: "MM yyyy", /* Leverages same syntax as 'format' */
          weekStart: 1
        };

        $('.input-daterange').datepicker({
          maxViewMode: 2,
          todayBtn: "linked",
          clearBtn: true,
          language: "de",
          format: 'dd.mm.yyyy',
          calendarWeeks: true,
          todayHighlight: true,
          autoclose: true,
          orientation: "right",
          templates: {leftArrow: '<i class="fas fa-long-arrow-alt-left"></i>', rightArrow: '<i class="fas fa-long-arrow-alt-right"></i>'}
        });
      });
    
    </script>

    <style>
      .ww {min-width: 700px;}
      .wv {min-width: 750px; max-width: 800px;}
      .wm {min-width: 400px;}
      .wf {min-width: 300px; max-width: 350px;}
      .ws {min-width: 400px; max-width: 700px; }
      .today {text-align: center;}
      .clear {text-align: center;}
      .cw {font-size:x-small;font-weight: bold;}
      .dow {font-size:x-small;font-weight: bold;text-align: center;}
      .datepicker-switch {text-align: center;}
      .next {text-align: right;}
      .day {text-align: center;}
      .old {font-style: italic;}
      .new {font-style: italic;}
      .rotate{transform: rotate(90deg);}
    </style>

    
  </head>

  <body ng-app="BBPCapa" ng-controller="BbpController as bbpList">
    <div class="container-fluid">
        <div class="row">
          <div class="page-header col-md-10">
            <i class="fas fa-route" style="color:#FF0000; font-size: 4em;""></i><b>&nbsp;</b>
            <i class="fas fa-chart-bar" style="color:#767171; font-size: 4em;"></i><b>&nbsp;</b>
            <b style="color:#767171; font-size: 4em;">&nbsp;BBP</b>
            <b style="color:#FF0000; font-size: 4em;"">Kapazitätsplanung</b>            
            <h3>Auslastungssteuerung Baubetriebsplanung</h3>
          </div>
          
          
          <div class="page-header col-md-2">
            <img src="./img/Db-netze.png" class="img-fluid" alt="DB Netz AG Logo">         
          </div>

          <div class="col-md-9 ng-hide animate-show-hide" ng-hide="bbpList.loadComplete">
            <div class="form-group">              
              <div class="col-md-8">                
                <input type="file" id="list" class="form-control form-control-lg" ng-model="mfbList.Filename" accept=".csv" placeholder="Liste auswählen"> <p></p>
                <p><b>Achtung</b> Es werden keinerlei Daten ins Netz hochgeladen. Der Verarbeitung der Daten und Erzeugung der Tabellen erfolgt ausschließlich auf dem lokalen Rechner.</p>
  
                <button type="button" class="btn btn-secondary btn-lg" ng-click="bbpList.findOverload();">
                    <i class="far fa-file-alt"></i>                    
                    Daten einlesen und verarbeiten
                </button>
              </div>         
            </div>
          </div>

          <div class="animate-show-hide ng-show" ng-show="bbpList.loadComplete">
            <nav>
              <div class="nav nav-tabs" id="nav-tab" role="tablist">
                <button class="nav-link active text-danger" id="nav-home-tab" data-bs-toggle="tab" data-bs-target="#nav-home" type="button" role="tab" aria-controls="nav-home" aria-selected="true">Streckenanalyse</button>
                <button class="nav-link text-danger" id="nav-profile-tab" data-bs-toggle="tab" data-bs-target="#nav-profile" type="button" role="tab" aria-controls="nav-profile" aria-selected="false">Details Auslastung</button>
                <button class="nav-link text-danger" id="nav-mfb-tab" data-bs-toggle="tab" data-bs-target="#nav-mfb" type="button" role="tab" aria-controls="nav-mfb" aria-selected="false">Umleitungen bearbeiten</button>
                <button class="nav-link text-light" id="nav-edit-tab" data-bs-toggle="tab" data-bs-target="#nav-edit" type="button" role="tab" aria-controls="nav-edit" aria-selected="false">&nbsp;</button>
              </div>
            </nav>
            <div class="tab-content" id="nav-tabContent">              
              <div class="tab-pane fade show active" id="nav-home" role="tabpanel" aria-labelledby="nav-home-tab">
                <div class="col-md-10">
                    <table class="table table-hover text-center">
                        <thead>
                            <tr class="table-secondary">
                                <th>Strecke</th>
                                <th>Abschnitt</th>
                                <th>Auslastungsstufe</th>
                                <th>Max. Auslastung</th>   
                                <th>Nennleistung unter Bau</th>
                                <th>SPFV</th>
                                <th>SPNV</th>
                                <th>SGV</th>
                                <th>Details</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr ng-repeat="tr in bbpList.TrackAnalysis | orderBy:['-MaxLoad', 'Strecke']">
                                <td>{{tr.Strecke}}</td>
                                <td>{{tr.From}} - {{tr.To}}</td>
                                <td ng-style="{'background-color': tr.Level.Col, 'color': 'white'}"><b>Stufe {{tr.Level.Lv}}</b></td>
                                <td>
                                    <span class="animate-show-hide ng-show" ng-hide="tr.MaxLoad===999999">{{tr.MaxLoad}} %</span>
                                    <span class="animate-show-hide ng-show" ng-show="tr.MaxLoad===999999">Totalsperrung</span>
                                </td>
                                <td>{{tr.Nennleistung}}</td>
                                <td>{{tr.SPFV}}</td>
                                <td>{{tr.SPNV}}</td>
                                <td>{{tr.SGV}}</td>
                                <td>
                                    <button type="button button-sm" ng-click="bbpList.showDetails(tr.Strecke);" class="btn btn-outline-secondary">
                                        <i class="far fa-hand-pointer"></i>
                                    </button>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
              </div>

              <div class="tab-pane fade" id="nav-profile" role="tabpanel" aria-labelledby="nav-profile-tab">
                <div class="col-md-10">
                    <h4>Strecke {{bbpList.showTrack}}</h4>
                    <h5>{{bbpList.FromDate}} - {{bbpList.ToDate}}</h5>
                    <table class="table table-hover text-center">
                        <thead>
                            <tr class="table-secondary">
                                <th>Datum</th>
                                <th>Abschnitt</th>
                                <th>Auslastungsstufe</th>
                                <th>Max. Auslastung</th>   
                                <th>Nennleistung unter Bau</th>
                                <th>SPFV</th>
                                <th>SPNV</th>
                                <th>SGV</th>
                                <th>Bearbeiten</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr ng-repeat="tr in bbpList.LoadAnalysis | orderBy:['Date.DNumber']">
                                <td>{{tr.Date.DText}}</td>
                                <td>{{tr.From}} - {{tr.To}}</td>
                                <td ng-style="{'background-color': tr.Level.Col, 'color': 'white'}"><b>Stufe {{tr.Level.Lv}}</b></td>
                                <td>
                                    <span class="animate-show-hide ng-show" ng-hide="tr.MaxLoad===999999">{{tr.MaxLoad}} %</span>
                                    <span class="animate-show-hide ng-show" ng-show="tr.MaxLoad===999999">Totalsperrung</span>
                                </td>
                                <td>{{tr.Nennleistung}}</td>
                                <td>{{tr.SPFV}}</td>
                                <td>{{tr.SPNV}}</td>
                                <td>{{tr.SGV}}</td>
                                <td>
                                    <button type="button button-sm" ng-click="bbpList.editRouting(bbpList.showTrack, tr.Date.DText);" class="btn btn-outline-secondary">
                                        <i class="fas fa-route"></i>
                                    </button>
                                </td>
                            </tr>
                        </tbody>
                    </table>                                        
                </div>
              </div>

              <div class="tab-pane fade" id="nav-mfb" role="tabpanel" aria-labelledby="nav-mfb-tab"> 
                  <div class="row">
                    <div class="col-md-4">
                        <h4>Strecke {{bbpList.showTrack}}</h4>
                        <p>Hier stehen viele nützliche Informationen.</p>
                    </div>
                    <div class="col-md-6">
                        <p>Übersichtskarte</p>
                        <div class="mapbbcode" id="railmap"> </div>
                    </div>
                  </div>
                  <hr>                    
                    <div class="col-md-10">
                        <h4>Bearbeitungsfenster</h4>
                        <p>Hier werden die Zugmengen zur Ausregelung bearbeitet.</p>
                    </div>                
              </div>

            </div>
          </div>

        </div>

        <div class="col-md-12">
            <p></p>
            <p><i class="fas fa-code"></i> <b>DB Netz AG</b> | Fahrplan und Kapazitätsmanagement | Region Mitte | I.NB-MI-F | 2021</p>
          </div>

    </div>

  </body>

  </html>